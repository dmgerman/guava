begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (C) 2016 The Guava Authors  *  * Licensed under the Apache License, Version 2.0 (the "License");  * you may not use this file except in compliance with the License.  * You may obtain a copy of the License at  *  * http://www.apache.org/licenses/LICENSE-2.0  *  * Unless required by applicable law or agreed to in writing, software  * distributed under the License is distributed on an "AS IS" BASIS,  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  * See the License for the specific language governing permissions and  * limitations under the License.  */
end_comment

begin_package
DECL|package|com.google.common.collect
package|package
name|com
operator|.
name|google
operator|.
name|common
operator|.
name|collect
package|;
end_package

begin_import
import|import static
name|com
operator|.
name|google
operator|.
name|common
operator|.
name|base
operator|.
name|Preconditions
operator|.
name|checkNotNull
import|;
end_import

begin_import
import|import static
name|com
operator|.
name|google
operator|.
name|common
operator|.
name|collect
operator|.
name|CollectPreconditions
operator|.
name|checkNonnegative
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|common
operator|.
name|annotations
operator|.
name|Beta
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|common
operator|.
name|annotations
operator|.
name|GwtCompatible
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Comparator
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Iterator
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Optional
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|stream
operator|.
name|Collector
import|;
end_import

begin_comment
comment|/**  * Provides static methods for working with {@link Comparator} instances. For many other helpful  * comparator utilities, see either {@code Comparator} itself (for Java 8 or later), or {@code  * com.google.common.collect.Ordering} (otherwise).  *  *<h3>Relationship to {@code Ordering}</h3>  *  *<p>In light of the significant enhancements to {@code Comparator} in Java 8, the overwhelming  * majority of usages of {@code Ordering} can be written using only built-in JDK APIs. This class is  * intended to "fill the gap" and provide those features of {@code Ordering} not already provided by  * the JDK.  *  * @since 21.0  * @author Louis Wasserman  */
end_comment

begin_class
annotation|@
name|Beta
annotation|@
name|GwtCompatible
DECL|class|Comparators
specifier|public
specifier|final
class|class
name|Comparators
block|{
DECL|method|Comparators ()
specifier|private
name|Comparators
parameter_list|()
block|{}
comment|/**    * Returns a new comparator which sorts iterables by comparing corresponding elements pairwise    * until a nonzero result is found; imposes "dictionary order." If the end of one iterable is    * reached, but not the other, the shorter iterable is considered to be less than the longer one.    * For example, a lexicographical natural ordering over integers considers {@code []< [1]< [1,    * 1]< [1, 2]< [2]}.    *    *<p>Note that {@code Collections.reverseOrder(lexicographical(comparator))} is not equivalent to    * {@code lexicographical(Collections.reverseOrder(comparator))} (consider how each would order    * {@code [1]} and {@code [1, 1]}).    */
comment|// Note: 90% of the time we don't add type parameters or wildcards that serve only to "tweak" the
comment|// desired return type. However, *nested* generics introduce a special class of problems that we
comment|// think tip it over into being worthwhile.
DECL|method|lexicographical (Comparator<T> comparator)
specifier|public
specifier|static
parameter_list|<
name|T
parameter_list|,
name|S
extends|extends
name|T
parameter_list|>
name|Comparator
argument_list|<
name|Iterable
argument_list|<
name|S
argument_list|>
argument_list|>
name|lexicographical
parameter_list|(
name|Comparator
argument_list|<
name|T
argument_list|>
name|comparator
parameter_list|)
block|{
return|return
operator|new
name|LexicographicalOrdering
argument_list|<
name|S
argument_list|>
argument_list|(
name|checkNotNull
argument_list|(
name|comparator
argument_list|)
argument_list|)
return|;
block|}
comment|/**    * Returns {@code true} if each element in {@code iterable} after the first is greater than or    * equal to the element that preceded it, according to the specified comparator. Note that this is    * always true when the iterable has fewer than two elements.    */
DECL|method|isInOrder (Iterable<? extends T> iterable, Comparator<T> comparator)
specifier|public
specifier|static
parameter_list|<
name|T
parameter_list|>
name|boolean
name|isInOrder
parameter_list|(
name|Iterable
argument_list|<
name|?
extends|extends
name|T
argument_list|>
name|iterable
parameter_list|,
name|Comparator
argument_list|<
name|T
argument_list|>
name|comparator
parameter_list|)
block|{
name|checkNotNull
argument_list|(
name|comparator
argument_list|)
expr_stmt|;
name|Iterator
argument_list|<
name|?
extends|extends
name|T
argument_list|>
name|it
init|=
name|iterable
operator|.
name|iterator
argument_list|()
decl_stmt|;
if|if
condition|(
name|it
operator|.
name|hasNext
argument_list|()
condition|)
block|{
name|T
name|prev
init|=
name|it
operator|.
name|next
argument_list|()
decl_stmt|;
while|while
condition|(
name|it
operator|.
name|hasNext
argument_list|()
condition|)
block|{
name|T
name|next
init|=
name|it
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
name|comparator
operator|.
name|compare
argument_list|(
name|prev
argument_list|,
name|next
argument_list|)
operator|>
literal|0
condition|)
block|{
return|return
literal|false
return|;
block|}
name|prev
operator|=
name|next
expr_stmt|;
block|}
block|}
return|return
literal|true
return|;
block|}
comment|/**    * Returns {@code true} if each element in {@code iterable} after the first is<i>strictly</i>    * greater than the element that preceded it, according to the specified comparator. Note that    * this is always true when the iterable has fewer than two elements.    */
DECL|method|isInStrictOrder ( Iterable<? extends T> iterable, Comparator<T> comparator)
specifier|public
specifier|static
parameter_list|<
name|T
parameter_list|>
name|boolean
name|isInStrictOrder
parameter_list|(
name|Iterable
argument_list|<
name|?
extends|extends
name|T
argument_list|>
name|iterable
parameter_list|,
name|Comparator
argument_list|<
name|T
argument_list|>
name|comparator
parameter_list|)
block|{
name|checkNotNull
argument_list|(
name|comparator
argument_list|)
expr_stmt|;
name|Iterator
argument_list|<
name|?
extends|extends
name|T
argument_list|>
name|it
init|=
name|iterable
operator|.
name|iterator
argument_list|()
decl_stmt|;
if|if
condition|(
name|it
operator|.
name|hasNext
argument_list|()
condition|)
block|{
name|T
name|prev
init|=
name|it
operator|.
name|next
argument_list|()
decl_stmt|;
while|while
condition|(
name|it
operator|.
name|hasNext
argument_list|()
condition|)
block|{
name|T
name|next
init|=
name|it
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
name|comparator
operator|.
name|compare
argument_list|(
name|prev
argument_list|,
name|next
argument_list|)
operator|>=
literal|0
condition|)
block|{
return|return
literal|false
return|;
block|}
name|prev
operator|=
name|next
expr_stmt|;
block|}
block|}
return|return
literal|true
return|;
block|}
comment|/**    * Returns a {@code Collector} that returns the {@code k} smallest (relative to the specified    * {@code Comparator}) input elements, in ascending order, as an unmodifiable {@code List}. Ties    * are broken arbitrarily.    *    *<p>For example:    *    *<pre>{@code    * Stream.of("foo", "quux", "banana", "elephant")    *     .collect(least(2, comparingInt(String::length)))    * // returns {"foo", "quux"}    * }</pre>    *    *<p>This {@code Collector} uses O(k) memory and takes expected time O(n) (worst-case O(n log    * k)), as opposed to e.g. {@code Stream.sorted(comparator).limit(k)}, which currently takes O(n    * log n) time and O(n) space.    *    * @throws IllegalArgumentException if {@code k< 0}    * @since 22.0    */
DECL|method|least (int k, Comparator<? super T> comparator)
specifier|public
specifier|static
parameter_list|<
name|T
parameter_list|>
name|Collector
argument_list|<
name|T
argument_list|,
name|?
argument_list|,
name|List
argument_list|<
name|T
argument_list|>
argument_list|>
name|least
parameter_list|(
name|int
name|k
parameter_list|,
name|Comparator
argument_list|<
name|?
super|super
name|T
argument_list|>
name|comparator
parameter_list|)
block|{
name|checkNonnegative
argument_list|(
name|k
argument_list|,
literal|"k"
argument_list|)
expr_stmt|;
name|checkNotNull
argument_list|(
name|comparator
argument_list|)
expr_stmt|;
return|return
name|Collector
operator|.
name|of
argument_list|(
parameter_list|()
lambda|->
name|TopKSelector
operator|.
block|<T>least(k
argument_list|,
name|comparator
argument_list|)
operator|,
name|TopKSelector
operator|::
name|offer
operator|,
name|TopKSelector
operator|::
name|combine
operator|,
name|TopKSelector
operator|::
name|topK
operator|,
name|Collector
operator|.
name|Characteristics
operator|.
name|UNORDERED
block|)
function|;
block|}
end_class

begin_comment
comment|/**    * Returns a {@code Collector} that returns the {@code k} greatest (relative to the specified    * {@code Comparator}) input elements, in descending order, as an unmodifiable {@code List}. Ties    * are broken arbitrarily.    *    *<p>For example:    *    *<pre>{@code    * Stream.of("foo", "quux", "banana", "elephant")    *     .collect(greatest(2, comparingInt(String::length)))    * // returns {"elephant", "banana"}    * }</pre>    *    *<p>This {@code Collector} uses O(k) memory and takes expected time O(n) (worst-case O(n log    * k)), as opposed to e.g. {@code Stream.sorted(comparator.reversed()).limit(k)}, which currently    * takes O(n log n) time and O(n) space.    *    * @throws IllegalArgumentException if {@code k< 0}    * @since 22.0    */
end_comment

begin_function
DECL|method|greatest (int k, Comparator<? super T> comparator)
specifier|public
specifier|static
parameter_list|<
name|T
parameter_list|>
name|Collector
argument_list|<
name|T
argument_list|,
name|?
argument_list|,
name|List
argument_list|<
name|T
argument_list|>
argument_list|>
name|greatest
parameter_list|(
name|int
name|k
parameter_list|,
name|Comparator
argument_list|<
name|?
super|super
name|T
argument_list|>
name|comparator
parameter_list|)
block|{
return|return
name|least
argument_list|(
name|k
argument_list|,
name|comparator
operator|.
name|reversed
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**    * Returns a comparator of {@link Optional} values which treats {@link Optional#empty} as less    * than all other values, and orders the rest using {@code valueComparator} on the contained    * value.    *    * @since 22.0    */
end_comment

begin_function
annotation|@
name|Beta
DECL|method|emptiesFirst (Comparator<T> valueComparator)
specifier|public
specifier|static
parameter_list|<
name|T
parameter_list|>
name|Comparator
argument_list|<
name|Optional
argument_list|<
name|T
argument_list|>
argument_list|>
name|emptiesFirst
parameter_list|(
name|Comparator
argument_list|<
name|T
argument_list|>
name|valueComparator
parameter_list|)
block|{
name|checkNotNull
argument_list|(
name|valueComparator
argument_list|)
expr_stmt|;
return|return
name|Comparator
operator|.
name|comparing
argument_list|(
name|o
lambda|->
name|o
operator|.
name|orElse
argument_list|(
literal|null
argument_list|)
argument_list|,
name|Comparator
operator|.
name|nullsFirst
argument_list|(
name|valueComparator
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**    * Returns a comparator of {@link Optional} values which treats {@link Optional#empty} as greater    * than all other values, and orders the rest using {@code valueComparator} on the contained    * value.    *    * @since 22.0    */
end_comment

begin_function
annotation|@
name|Beta
DECL|method|emptiesLast (Comparator<T> valueComparator)
specifier|public
specifier|static
parameter_list|<
name|T
parameter_list|>
name|Comparator
argument_list|<
name|Optional
argument_list|<
name|T
argument_list|>
argument_list|>
name|emptiesLast
parameter_list|(
name|Comparator
argument_list|<
name|T
argument_list|>
name|valueComparator
parameter_list|)
block|{
name|checkNotNull
argument_list|(
name|valueComparator
argument_list|)
expr_stmt|;
return|return
name|Comparator
operator|.
name|comparing
argument_list|(
name|o
lambda|->
name|o
operator|.
name|orElse
argument_list|(
literal|null
argument_list|)
argument_list|,
name|Comparator
operator|.
name|nullsLast
argument_list|(
name|valueComparator
argument_list|)
argument_list|)
return|;
block|}
end_function

unit|}
end_unit

